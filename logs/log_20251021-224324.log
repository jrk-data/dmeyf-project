2025-10-21 22:43:24,582 - __main__ - INFO - L40 - Configuraci√≥n cargada desde YAML
2025-10-21 22:43:24,582 - __main__ - INFO - L41 - STUDY_NAME: lgb_optimization_competencia01
2025-10-21 22:43:24,582 - __main__ - INFO - L42 - DATA_PATH: data/competencia_01.csv
2025-10-21 22:43:24,582 - __main__ - INFO - L43 - DB_PATH: data/churn.duckdb
2025-10-21 22:43:24,583 - __main__ - INFO - L44 - SEMILLA: [42]
2025-10-21 22:43:24,583 - __main__ - INFO - L45 - MES_TRAIN: 202102
2025-10-21 22:43:24,583 - __main__ - INFO - L46 - MES_VALIDACION: 202103
2025-10-21 22:43:24,583 - __main__ - INFO - L47 - MES_TEST: 202104
2025-10-21 22:43:24,583 - __main__ - INFO - L48 - GANANCIA_ACIERTO: 780000
2025-10-21 22:43:24,583 - __main__ - INFO - L49 - COSTO_ESTIMULO: 20000
2025-10-21 22:43:24,583 - __main__ - INFO - L53 - Entrenando con SEMILLA=[42], TRAIN=202102, VALID=202103
2025-10-21 22:43:24,583 - __main__ - INFO - L60 - Usando base de datos existente...
2025-10-21 22:43:24,583 - __main__ - INFO - L63 - Cargando dataset comision_01...
2025-10-21 22:43:26,249 - __main__ - INFO - L69 - #### INICIO FEATURE ENGINEERING ###
2025-10-21 22:43:26,250 - __main__ - INFO - L70 - Creando Lags...
2025-10-21 22:43:26,253 - src.features - DEBUG - L46 - Consulta SQL: SELECT active_quarter, lag(active_quarter, 0) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS active_quarter_lag_0, cliente_vip, lag(cliente_vip, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS cliente_vip_lag_1, internet, lag(internet, 2) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS internet_lag_2, cliente_edad, lag(cliente_edad, 3) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS cliente_edad_lag_3, cliente_antiguedad, lag(cliente_antiguedad, 4) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS cliente_antiguedad_lag_4, mrentabilidad, lag(mrentabilidad, 5) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mrentabilidad_lag_5, mrentabilidad_annual, lag(mrentabilidad_annual, 6) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mrentabilidad_annual_lag_6, mcomisiones, lag(mcomisiones, 7) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mcomisiones_lag_7, mactivos_margen, lag(mactivos_margen, 8) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mactivos_margen_lag_8, mpasivos_margen, lag(mpasivos_margen, 9) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mpasivos_margen_lag_9, cproductos, lag(cproductos, 10) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS cproductos_lag_10, tcuentas, lag(tcuentas, 11) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS tcuentas_lag_11, ccuenta_corriente, lag(ccuenta_corriente, 12) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ccuenta_corriente_lag_12, mcuenta_corriente_adicional, lag(mcuenta_corriente_adicional, 13) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mcuenta_corriente_adicional_lag_13, mcuenta_corriente, lag(mcuenta_corriente, 14) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mcuenta_corriente_lag_14, ccaja_ahorro, lag(ccaja_ahorro, 15) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ccaja_ahorro_lag_15, mcaja_ahorro, lag(mcaja_ahorro, 16) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mcaja_ahorro_lag_16, mcaja_ahorro_adicional, lag(mcaja_ahorro_adicional, 17) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mcaja_ahorro_adicional_lag_17, mcaja_ahorro_dolares, lag(mcaja_ahorro_dolares, 18) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mcaja_ahorro_dolares_lag_18, cdescubierto_preacordado, lag(cdescubierto_preacordado, 19) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS cdescubierto_preacordado_lag_19, mcuentas_saldo, lag(mcuentas_saldo, 20) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mcuentas_saldo_lag_20, ctarjeta_debito, lag(ctarjeta_debito, 21) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ctarjeta_debito_lag_21, ctarjeta_debito_transacciones, lag(ctarjeta_debito_transacciones, 22) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ctarjeta_debito_transacciones_lag_22, mautoservicio, lag(mautoservicio, 23) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mautoservicio_lag_23, ctarjeta_visa, lag(ctarjeta_visa, 24) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ctarjeta_visa_lag_24, ctarjeta_visa_transacciones, lag(ctarjeta_visa_transacciones, 25) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ctarjeta_visa_transacciones_lag_25, mtarjeta_visa_consumo, lag(mtarjeta_visa_consumo, 26) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mtarjeta_visa_consumo_lag_26, ctarjeta_master, lag(ctarjeta_master, 27) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ctarjeta_master_lag_27, ctarjeta_master_transacciones, lag(ctarjeta_master_transacciones, 28) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ctarjeta_master_transacciones_lag_28, mtarjeta_master_consumo, lag(mtarjeta_master_consumo, 29) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mtarjeta_master_consumo_lag_29, cprestamos_personales, lag(cprestamos_personales, 30) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS cprestamos_personales_lag_30, mprestamos_personales, lag(mprestamos_personales, 31) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mprestamos_personales_lag_31, cprestamos_prendarios, lag(cprestamos_prendarios, 32) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS cprestamos_prendarios_lag_32, mprestamos_prendarios, lag(mprestamos_prendarios, 33) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mprestamos_prendarios_lag_33, cprestamos_hipotecarios, lag(cprestamos_hipotecarios, 34) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS cprestamos_hipotecarios_lag_34, mprestamos_hipotecarios, lag(mprestamos_hipotecarios, 35) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mprestamos_hipotecarios_lag_35, cplazo_fijo, lag(cplazo_fijo, 36) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS cplazo_fijo_lag_36, mplazo_fijo_dolares, lag(mplazo_fijo_dolares, 37) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mplazo_fijo_dolares_lag_37, mplazo_fijo_pesos, lag(mplazo_fijo_pesos, 38) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mplazo_fijo_pesos_lag_38, cinversion1, lag(cinversion1, 39) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS cinversion1_lag_39, minversion1_pesos, lag(minversion1_pesos, 40) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS minversion1_pesos_lag_40, minversion1_dolares, lag(minversion1_dolares, 41) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS minversion1_dolares_lag_41, cinversion2, lag(cinversion2, 42) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS cinversion2_lag_42, minversion2, lag(minversion2, 43) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS minversion2_lag_43, cseguro_vida, lag(cseguro_vida, 44) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS cseguro_vida_lag_44, cseguro_auto, lag(cseguro_auto, 45) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS cseguro_auto_lag_45, cseguro_vivienda, lag(cseguro_vivienda, 46) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS cseguro_vivienda_lag_46, cseguro_accidentes_personales, lag(cseguro_accidentes_personales, 47) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS cseguro_accidentes_personales_lag_47, ccaja_seguridad, lag(ccaja_seguridad, 48) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ccaja_seguridad_lag_48, cpayroll_trx, lag(cpayroll_trx, 49) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS cpayroll_trx_lag_49, mpayroll, lag(mpayroll, 50) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mpayroll_lag_50, mpayroll2, lag(mpayroll2, 51) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mpayroll2_lag_51, cpayroll2_trx, lag(cpayroll2_trx, 52) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS cpayroll2_trx_lag_52, ccuenta_debitos_automaticos, lag(ccuenta_debitos_automaticos, 53) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ccuenta_debitos_automaticos_lag_53, mcuenta_debitos_automaticos, lag(mcuenta_debitos_automaticos, 54) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mcuenta_debitos_automaticos_lag_54, ctarjeta_visa_debitos_automaticos, lag(ctarjeta_visa_debitos_automaticos, 55) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ctarjeta_visa_debitos_automaticos_lag_55, mttarjeta_visa_debitos_automaticos, lag(mttarjeta_visa_debitos_automaticos, 56) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mttarjeta_visa_debitos_automaticos_lag_56, ctarjeta_master_debitos_automaticos, lag(ctarjeta_master_debitos_automaticos, 57) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ctarjeta_master_debitos_automaticos_lag_57, mttarjeta_master_debitos_automaticos, lag(mttarjeta_master_debitos_automaticos, 58) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mttarjeta_master_debitos_automaticos_lag_58, cpagodeservicios, lag(cpagodeservicios, 59) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS cpagodeservicios_lag_59, mpagodeservicios, lag(mpagodeservicios, 60) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mpagodeservicios_lag_60, cpagomiscuentas, lag(cpagomiscuentas, 61) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS cpagomiscuentas_lag_61, mpagomiscuentas, lag(mpagomiscuentas, 62) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mpagomiscuentas_lag_62, ccajeros_propios_descuentos, lag(ccajeros_propios_descuentos, 63) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ccajeros_propios_descuentos_lag_63, mcajeros_propios_descuentos, lag(mcajeros_propios_descuentos, 64) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mcajeros_propios_descuentos_lag_64, ctarjeta_visa_descuentos, lag(ctarjeta_visa_descuentos, 65) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ctarjeta_visa_descuentos_lag_65, mtarjeta_visa_descuentos, lag(mtarjeta_visa_descuentos, 66) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mtarjeta_visa_descuentos_lag_66, ctarjeta_master_descuentos, lag(ctarjeta_master_descuentos, 67) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ctarjeta_master_descuentos_lag_67, mtarjeta_master_descuentos, lag(mtarjeta_master_descuentos, 68) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mtarjeta_master_descuentos_lag_68, ccomisiones_mantenimiento, lag(ccomisiones_mantenimiento, 69) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ccomisiones_mantenimiento_lag_69, mcomisiones_mantenimiento, lag(mcomisiones_mantenimiento, 70) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mcomisiones_mantenimiento_lag_70, ccomisiones_otras, lag(ccomisiones_otras, 71) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ccomisiones_otras_lag_71, mcomisiones_otras, lag(mcomisiones_otras, 72) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mcomisiones_otras_lag_72, cforex, lag(cforex, 73) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS cforex_lag_73, cforex_buy, lag(cforex_buy, 74) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS cforex_buy_lag_74, mforex_buy, lag(mforex_buy, 75) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mforex_buy_lag_75, cforex_sell, lag(cforex_sell, 76) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS cforex_sell_lag_76, mforex_sell, lag(mforex_sell, 77) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mforex_sell_lag_77, ctransferencias_recibidas, lag(ctransferencias_recibidas, 78) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ctransferencias_recibidas_lag_78, mtransferencias_recibidas, lag(mtransferencias_recibidas, 79) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mtransferencias_recibidas_lag_79, ctransferencias_emitidas, lag(ctransferencias_emitidas, 80) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ctransferencias_emitidas_lag_80, mtransferencias_emitidas, lag(mtransferencias_emitidas, 81) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mtransferencias_emitidas_lag_81, cextraccion_autoservicio, lag(cextraccion_autoservicio, 82) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS cextraccion_autoservicio_lag_82, mextraccion_autoservicio, lag(mextraccion_autoservicio, 83) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mextraccion_autoservicio_lag_83, ccheques_depositados, lag(ccheques_depositados, 84) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ccheques_depositados_lag_84, mcheques_depositados, lag(mcheques_depositados, 85) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mcheques_depositados_lag_85, ccheques_emitidos, lag(ccheques_emitidos, 86) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ccheques_emitidos_lag_86, mcheques_emitidos, lag(mcheques_emitidos, 87) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mcheques_emitidos_lag_87, ccheques_depositados_rechazados, lag(ccheques_depositados_rechazados, 88) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ccheques_depositados_rechazados_lag_88, mcheques_depositados_rechazados, lag(mcheques_depositados_rechazados, 89) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mcheques_depositados_rechazados_lag_89, ccheques_emitidos_rechazados, lag(ccheques_emitidos_rechazados, 90) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ccheques_emitidos_rechazados_lag_90, mcheques_emitidos_rechazados, lag(mcheques_emitidos_rechazados, 91) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mcheques_emitidos_rechazados_lag_91, tcallcenter, lag(tcallcenter, 92) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS tcallcenter_lag_92, ccallcenter_transacciones, lag(ccallcenter_transacciones, 93) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ccallcenter_transacciones_lag_93, thomebanking, lag(thomebanking, 94) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS thomebanking_lag_94, chomebanking_transacciones, lag(chomebanking_transacciones, 95) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS chomebanking_transacciones_lag_95, ccajas_transacciones, lag(ccajas_transacciones, 96) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ccajas_transacciones_lag_96, ccajas_consultas, lag(ccajas_consultas, 97) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ccajas_consultas_lag_97, ccajas_depositos, lag(ccajas_depositos, 98) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ccajas_depositos_lag_98, ccajas_extracciones, lag(ccajas_extracciones, 99) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ccajas_extracciones_lag_99, ccajas_otras, lag(ccajas_otras, 100) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ccajas_otras_lag_100, catm_trx, lag(catm_trx, 101) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS catm_trx_lag_101, matm, lag(matm, 102) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS matm_lag_102, catm_trx_other, lag(catm_trx_other, 103) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS catm_trx_other_lag_103, matm_other, lag(matm_other, 104) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS matm_other_lag_104, ctrx_quarter, lag(ctrx_quarter, 105) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ctrx_quarter_lag_105, tmobile_app, lag(tmobile_app, 106) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS tmobile_app_lag_106, cmobile_app_trx, lag(cmobile_app_trx, 107) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS cmobile_app_trx_lag_107, Master_delinquency, lag(Master_delinquency, 108) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Master_delinquency_lag_108, Master_status, lag(Master_status, 109) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Master_status_lag_109, Master_mfinanciacion_limite, lag(Master_mfinanciacion_limite, 110) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Master_mfinanciacion_limite_lag_110, Master_Fvencimiento, lag(Master_Fvencimiento, 111) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Master_Fvencimiento_lag_111, Master_Finiciomora, lag(Master_Finiciomora, 112) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Master_Finiciomora_lag_112, Master_msaldototal, lag(Master_msaldototal, 113) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Master_msaldototal_lag_113, Master_msaldopesos, lag(Master_msaldopesos, 114) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Master_msaldopesos_lag_114, Master_msaldodolares, lag(Master_msaldodolares, 115) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Master_msaldodolares_lag_115, Master_mconsumospesos, lag(Master_mconsumospesos, 116) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Master_mconsumospesos_lag_116, Master_mconsumosdolares, lag(Master_mconsumosdolares, 117) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Master_mconsumosdolares_lag_117, Master_mlimitecompra, lag(Master_mlimitecompra, 118) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Master_mlimitecompra_lag_118, Master_madelantopesos, lag(Master_madelantopesos, 119) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Master_madelantopesos_lag_119, Master_madelantodolares, lag(Master_madelantodolares, 120) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Master_madelantodolares_lag_120, Master_fultimo_cierre, lag(Master_fultimo_cierre, 121) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Master_fultimo_cierre_lag_121, Master_mpagado, lag(Master_mpagado, 122) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Master_mpagado_lag_122, Master_mpagospesos, lag(Master_mpagospesos, 123) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Master_mpagospesos_lag_123, Master_mpagosdolares, lag(Master_mpagosdolares, 124) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Master_mpagosdolares_lag_124, Master_fechaalta, lag(Master_fechaalta, 125) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Master_fechaalta_lag_125, Master_mconsumototal, lag(Master_mconsumototal, 126) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Master_mconsumototal_lag_126, Master_cconsumos, lag(Master_cconsumos, 127) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Master_cconsumos_lag_127, Master_cadelantosefectivo, lag(Master_cadelantosefectivo, 128) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Master_cadelantosefectivo_lag_128, Master_mpagominimo, lag(Master_mpagominimo, 129) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Master_mpagominimo_lag_129, Visa_delinquency, lag(Visa_delinquency, 130) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Visa_delinquency_lag_130, Visa_status, lag(Visa_status, 131) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Visa_status_lag_131, Visa_mfinanciacion_limite, lag(Visa_mfinanciacion_limite, 132) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Visa_mfinanciacion_limite_lag_132, Visa_Fvencimiento, lag(Visa_Fvencimiento, 133) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Visa_Fvencimiento_lag_133, Visa_Finiciomora, lag(Visa_Finiciomora, 134) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Visa_Finiciomora_lag_134, Visa_msaldototal, lag(Visa_msaldototal, 135) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Visa_msaldototal_lag_135, Visa_msaldopesos, lag(Visa_msaldopesos, 136) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Visa_msaldopesos_lag_136, Visa_msaldodolares, lag(Visa_msaldodolares, 137) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Visa_msaldodolares_lag_137, Visa_mconsumospesos, lag(Visa_mconsumospesos, 138) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Visa_mconsumospesos_lag_138, Visa_mconsumosdolares, lag(Visa_mconsumosdolares, 139) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Visa_mconsumosdolares_lag_139, Visa_mlimitecompra, lag(Visa_mlimitecompra, 140) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Visa_mlimitecompra_lag_140, Visa_madelantopesos, lag(Visa_madelantopesos, 141) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Visa_madelantopesos_lag_141, Visa_madelantodolares, lag(Visa_madelantodolares, 142) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Visa_madelantodolares_lag_142, Visa_fultimo_cierre, lag(Visa_fultimo_cierre, 143) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Visa_fultimo_cierre_lag_143, Visa_mpagado, lag(Visa_mpagado, 144) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Visa_mpagado_lag_144, Visa_mpagospesos, lag(Visa_mpagospesos, 145) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Visa_mpagospesos_lag_145, Visa_mpagosdolares, lag(Visa_mpagosdolares, 146) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Visa_mpagosdolares_lag_146, Visa_fechaalta, lag(Visa_fechaalta, 147) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Visa_fechaalta_lag_147, Visa_mconsumototal, lag(Visa_mconsumototal, 148) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Visa_mconsumototal_lag_148, Visa_cconsumos, lag(Visa_cconsumos, 149) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Visa_cconsumos_lag_149, Visa_cadelantosefectivo, lag(Visa_cadelantosefectivo, 150) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Visa_cadelantosefectivo_lag_150, Visa_mpagominimo, lag(Visa_mpagominimo, 151) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Visa_mpagominimo_lag_151,  * FROM df
2025-10-21 22:43:36,238 - src.features - INFO - L53 - Se han calculado lags de 1 orden para 152 columnas.
2025-10-21 22:43:36,238 - __main__ - INFO - L79 - Creando Deltas...
2025-10-21 22:43:36,317 - src.features - DEBUG - L111 - Consulta SQL (deltas): SELECT *, (active_quarter - lag(active_quarter, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_active_quarter_1, (cliente_vip - lag(cliente_vip, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_cliente_vip_1, (internet - lag(internet, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_internet_1, (cliente_edad - lag(cliente_edad, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_cliente_edad_1, (cliente_antiguedad - lag(cliente_antiguedad, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_cliente_antiguedad_1, (mrentabilidad - lag(mrentabilidad, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mrentabilidad_1, (mrentabilidad_annual - lag(mrentabilidad_annual, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mrentabilidad_annual_1, (mcomisiones - lag(mcomisiones, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mcomisiones_1, (mactivos_margen - lag(mactivos_margen, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mactivos_margen_1, (mpasivos_margen - lag(mpasivos_margen, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mpasivos_margen_1, (cproductos - lag(cproductos, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_cproductos_1, (tcuentas - lag(tcuentas, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_tcuentas_1, (ccuenta_corriente - lag(ccuenta_corriente, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_ccuenta_corriente_1, (mcuenta_corriente_adicional - lag(mcuenta_corriente_adicional, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mcuenta_corriente_adicional_1, (mcuenta_corriente - lag(mcuenta_corriente, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mcuenta_corriente_1, (ccaja_ahorro - lag(ccaja_ahorro, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_ccaja_ahorro_1, (mcaja_ahorro - lag(mcaja_ahorro, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mcaja_ahorro_1, (mcaja_ahorro_adicional - lag(mcaja_ahorro_adicional, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mcaja_ahorro_adicional_1, (mcaja_ahorro_dolares - lag(mcaja_ahorro_dolares, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mcaja_ahorro_dolares_1, (cdescubierto_preacordado - lag(cdescubierto_preacordado, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_cdescubierto_preacordado_1, (mcuentas_saldo - lag(mcuentas_saldo, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mcuentas_saldo_1, (ctarjeta_debito - lag(ctarjeta_debito, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_ctarjeta_debito_1, (ctarjeta_debito_transacciones - lag(ctarjeta_debito_transacciones, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_ctarjeta_debito_transacciones_1, (mautoservicio - lag(mautoservicio, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mautoservicio_1, (ctarjeta_visa - lag(ctarjeta_visa, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_ctarjeta_visa_1, (ctarjeta_visa_transacciones - lag(ctarjeta_visa_transacciones, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_ctarjeta_visa_transacciones_1, (mtarjeta_visa_consumo - lag(mtarjeta_visa_consumo, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mtarjeta_visa_consumo_1, (ctarjeta_master - lag(ctarjeta_master, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_ctarjeta_master_1, (ctarjeta_master_transacciones - lag(ctarjeta_master_transacciones, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_ctarjeta_master_transacciones_1, (mtarjeta_master_consumo - lag(mtarjeta_master_consumo, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mtarjeta_master_consumo_1, (cprestamos_personales - lag(cprestamos_personales, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_cprestamos_personales_1, (mprestamos_personales - lag(mprestamos_personales, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mprestamos_personales_1, (cprestamos_prendarios - lag(cprestamos_prendarios, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_cprestamos_prendarios_1, (mprestamos_prendarios - lag(mprestamos_prendarios, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mprestamos_prendarios_1, (cprestamos_hipotecarios - lag(cprestamos_hipotecarios, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_cprestamos_hipotecarios_1, (mprestamos_hipotecarios - lag(mprestamos_hipotecarios, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mprestamos_hipotecarios_1, (cplazo_fijo - lag(cplazo_fijo, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_cplazo_fijo_1, (mplazo_fijo_dolares - lag(mplazo_fijo_dolares, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mplazo_fijo_dolares_1, (mplazo_fijo_pesos - lag(mplazo_fijo_pesos, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mplazo_fijo_pesos_1, (cinversion1 - lag(cinversion1, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_cinversion1_1, (minversion1_pesos - lag(minversion1_pesos, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_minversion1_pesos_1, (minversion1_dolares - lag(minversion1_dolares, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_minversion1_dolares_1, (cinversion2 - lag(cinversion2, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_cinversion2_1, (minversion2 - lag(minversion2, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_minversion2_1, (cseguro_vida - lag(cseguro_vida, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_cseguro_vida_1, (cseguro_auto - lag(cseguro_auto, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_cseguro_auto_1, (cseguro_vivienda - lag(cseguro_vivienda, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_cseguro_vivienda_1, (cseguro_accidentes_personales - lag(cseguro_accidentes_personales, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_cseguro_accidentes_personales_1, (ccaja_seguridad - lag(ccaja_seguridad, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_ccaja_seguridad_1, (cpayroll_trx - lag(cpayroll_trx, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_cpayroll_trx_1, (mpayroll - lag(mpayroll, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mpayroll_1, (mpayroll2 - lag(mpayroll2, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mpayroll2_1, (cpayroll2_trx - lag(cpayroll2_trx, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_cpayroll2_trx_1, (ccuenta_debitos_automaticos - lag(ccuenta_debitos_automaticos, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_ccuenta_debitos_automaticos_1, (mcuenta_debitos_automaticos - lag(mcuenta_debitos_automaticos, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mcuenta_debitos_automaticos_1, (ctarjeta_visa_debitos_automaticos - lag(ctarjeta_visa_debitos_automaticos, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_ctarjeta_visa_debitos_automaticos_1, (mttarjeta_visa_debitos_automaticos - lag(mttarjeta_visa_debitos_automaticos, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mttarjeta_visa_debitos_automaticos_1, (ctarjeta_master_debitos_automaticos - lag(ctarjeta_master_debitos_automaticos, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_ctarjeta_master_debitos_automaticos_1, (mttarjeta_master_debitos_automaticos - lag(mttarjeta_master_debitos_automaticos, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mttarjeta_master_debitos_automaticos_1, (cpagodeservicios - lag(cpagodeservicios, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_cpagodeservicios_1, (mpagodeservicios - lag(mpagodeservicios, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mpagodeservicios_1, (cpagomiscuentas - lag(cpagomiscuentas, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_cpagomiscuentas_1, (mpagomiscuentas - lag(mpagomiscuentas, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mpagomiscuentas_1, (ccajeros_propios_descuentos - lag(ccajeros_propios_descuentos, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_ccajeros_propios_descuentos_1, (mcajeros_propios_descuentos - lag(mcajeros_propios_descuentos, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mcajeros_propios_descuentos_1, (ctarjeta_visa_descuentos - lag(ctarjeta_visa_descuentos, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_ctarjeta_visa_descuentos_1, (mtarjeta_visa_descuentos - lag(mtarjeta_visa_descuentos, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mtarjeta_visa_descuentos_1, (ctarjeta_master_descuentos - lag(ctarjeta_master_descuentos, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_ctarjeta_master_descuentos_1, (mtarjeta_master_descuentos - lag(mtarjeta_master_descuentos, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mtarjeta_master_descuentos_1, (ccomisiones_mantenimiento - lag(ccomisiones_mantenimiento, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_ccomisiones_mantenimiento_1, (mcomisiones_mantenimiento - lag(mcomisiones_mantenimiento, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mcomisiones_mantenimiento_1, (ccomisiones_otras - lag(ccomisiones_otras, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_ccomisiones_otras_1, (mcomisiones_otras - lag(mcomisiones_otras, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mcomisiones_otras_1, (cforex - lag(cforex, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_cforex_1, (cforex_buy - lag(cforex_buy, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_cforex_buy_1, (mforex_buy - lag(mforex_buy, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mforex_buy_1, (cforex_sell - lag(cforex_sell, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_cforex_sell_1, (mforex_sell - lag(mforex_sell, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mforex_sell_1, (ctransferencias_recibidas - lag(ctransferencias_recibidas, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_ctransferencias_recibidas_1, (mtransferencias_recibidas - lag(mtransferencias_recibidas, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mtransferencias_recibidas_1, (ctransferencias_emitidas - lag(ctransferencias_emitidas, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_ctransferencias_emitidas_1, (mtransferencias_emitidas - lag(mtransferencias_emitidas, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mtransferencias_emitidas_1, (cextraccion_autoservicio - lag(cextraccion_autoservicio, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_cextraccion_autoservicio_1, (mextraccion_autoservicio - lag(mextraccion_autoservicio, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mextraccion_autoservicio_1, (ccheques_depositados - lag(ccheques_depositados, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_ccheques_depositados_1, (mcheques_depositados - lag(mcheques_depositados, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mcheques_depositados_1, (ccheques_emitidos - lag(ccheques_emitidos, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_ccheques_emitidos_1, (mcheques_emitidos - lag(mcheques_emitidos, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mcheques_emitidos_1, (ccheques_depositados_rechazados - lag(ccheques_depositados_rechazados, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_ccheques_depositados_rechazados_1, (mcheques_depositados_rechazados - lag(mcheques_depositados_rechazados, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mcheques_depositados_rechazados_1, (ccheques_emitidos_rechazados - lag(ccheques_emitidos_rechazados, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_ccheques_emitidos_rechazados_1, (mcheques_emitidos_rechazados - lag(mcheques_emitidos_rechazados, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_mcheques_emitidos_rechazados_1, (tcallcenter - lag(tcallcenter, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_tcallcenter_1, (ccallcenter_transacciones - lag(ccallcenter_transacciones, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_ccallcenter_transacciones_1, (thomebanking - lag(thomebanking, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_thomebanking_1, (chomebanking_transacciones - lag(chomebanking_transacciones, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_chomebanking_transacciones_1, (ccajas_transacciones - lag(ccajas_transacciones, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_ccajas_transacciones_1, (ccajas_consultas - lag(ccajas_consultas, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_ccajas_consultas_1, (ccajas_depositos - lag(ccajas_depositos, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_ccajas_depositos_1, (ccajas_extracciones - lag(ccajas_extracciones, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_ccajas_extracciones_1, (ccajas_otras - lag(ccajas_otras, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_ccajas_otras_1, (catm_trx - lag(catm_trx, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_catm_trx_1, (matm - lag(matm, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_matm_1, (catm_trx_other - lag(catm_trx_other, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_catm_trx_other_1, (matm_other - lag(matm_other, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_matm_other_1, (ctrx_quarter - lag(ctrx_quarter, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_ctrx_quarter_1, (tmobile_app - lag(tmobile_app, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_tmobile_app_1, (cmobile_app_trx - lag(cmobile_app_trx, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_cmobile_app_trx_1, (Master_delinquency - lag(Master_delinquency, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Master_delinquency_1, (Master_status - lag(Master_status, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Master_status_1, (Master_mfinanciacion_limite - lag(Master_mfinanciacion_limite, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Master_mfinanciacion_limite_1, (Master_Fvencimiento - lag(Master_Fvencimiento, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Master_Fvencimiento_1, (Master_Finiciomora - lag(Master_Finiciomora, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Master_Finiciomora_1, (Master_msaldototal - lag(Master_msaldototal, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Master_msaldototal_1, (Master_msaldopesos - lag(Master_msaldopesos, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Master_msaldopesos_1, (Master_msaldodolares - lag(Master_msaldodolares, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Master_msaldodolares_1, (Master_mconsumospesos - lag(Master_mconsumospesos, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Master_mconsumospesos_1, (Master_mconsumosdolares - lag(Master_mconsumosdolares, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Master_mconsumosdolares_1, (Master_mlimitecompra - lag(Master_mlimitecompra, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Master_mlimitecompra_1, (Master_madelantopesos - lag(Master_madelantopesos, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Master_madelantopesos_1, (Master_madelantodolares - lag(Master_madelantodolares, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Master_madelantodolares_1, (Master_fultimo_cierre - lag(Master_fultimo_cierre, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Master_fultimo_cierre_1, (Master_mpagado - lag(Master_mpagado, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Master_mpagado_1, (Master_mpagospesos - lag(Master_mpagospesos, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Master_mpagospesos_1, (Master_mpagosdolares - lag(Master_mpagosdolares, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Master_mpagosdolares_1, (Master_fechaalta - lag(Master_fechaalta, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Master_fechaalta_1, (Master_mconsumototal - lag(Master_mconsumototal, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Master_mconsumototal_1, (Master_cconsumos - lag(Master_cconsumos, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Master_cconsumos_1, (Master_cadelantosefectivo - lag(Master_cadelantosefectivo, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Master_cadelantosefectivo_1, (Master_mpagominimo - lag(Master_mpagominimo, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Master_mpagominimo_1, (Visa_delinquency - lag(Visa_delinquency, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Visa_delinquency_1, (Visa_status - lag(Visa_status, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Visa_status_1, (Visa_mfinanciacion_limite - lag(Visa_mfinanciacion_limite, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Visa_mfinanciacion_limite_1, (Visa_Fvencimiento - lag(Visa_Fvencimiento, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Visa_Fvencimiento_1, (Visa_Finiciomora - lag(Visa_Finiciomora, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Visa_Finiciomora_1, (Visa_msaldototal - lag(Visa_msaldototal, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Visa_msaldototal_1, (Visa_msaldopesos - lag(Visa_msaldopesos, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Visa_msaldopesos_1, (Visa_msaldodolares - lag(Visa_msaldodolares, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Visa_msaldodolares_1, (Visa_mconsumospesos - lag(Visa_mconsumospesos, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Visa_mconsumospesos_1, (Visa_mconsumosdolares - lag(Visa_mconsumosdolares, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Visa_mconsumosdolares_1, (Visa_mlimitecompra - lag(Visa_mlimitecompra, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Visa_mlimitecompra_1, (Visa_madelantopesos - lag(Visa_madelantopesos, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Visa_madelantopesos_1, (Visa_madelantodolares - lag(Visa_madelantodolares, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Visa_madelantodolares_1, (Visa_fultimo_cierre - lag(Visa_fultimo_cierre, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Visa_fultimo_cierre_1, (Visa_mpagado - lag(Visa_mpagado, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Visa_mpagado_1, (Visa_mpagospesos - lag(Visa_mpagospesos, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Visa_mpagospesos_1, (Visa_mpagosdolares - lag(Visa_mpagosdolares, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Visa_mpagosdolares_1, (Visa_fechaalta - lag(Visa_fechaalta, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Visa_fechaalta_1, (Visa_mconsumototal - lag(Visa_mconsumototal, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Visa_mconsumototal_1, (Visa_cconsumos - lag(Visa_cconsumos, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Visa_cconsumos_1, (Visa_cadelantosefectivo - lag(Visa_cadelantosefectivo, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Visa_cadelantosefectivo_1, (Visa_mpagominimo - lag(Visa_mpagominimo, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes)) AS delta_Visa_mpagominimo_1 FROM df
2025-10-21 22:43:54,172 - src.features - INFO - L121 - Se han calculado 1 deltas para 152 campos.
2025-10-21 22:43:54,174 - __main__ - INFO - L81 - Data shape: (978439, 611)
2025-10-21 22:43:54,174 - __main__ - INFO - L83 - #### FIN FEATURE ENGINEERING ###
2025-10-21 22:43:54,174 - __main__ - INFO - L86 - Binarizando target...
