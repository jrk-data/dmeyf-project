2025-11-02 21:15:56,100 - __main__ - INFO - L20 - Logger inicializado
2025-11-02 21:15:57,152 - numexpr.utils - INFO - L164 - NumExpr defaulting to 8 threads.
2025-11-02 21:15:58,120 - __main__ - INFO - L72 - Configuración cargada desde YAML
2025-11-02 21:15:58,120 - __main__ - INFO - L73 - CREAR_NUEVA_BASE: True
2025-11-02 21:15:58,120 - __main__ - INFO - L74 - STUDY_NAME: lgb_optimization_exp1_vm
2025-11-02 21:15:58,120 - __main__ - INFO - L75 - DATA_PATH: data/competencia_01.csv
2025-11-02 21:15:58,120 - __main__ - INFO - L76 - DB_PATH: /home/joaquinrk_data/buckets/b1/datasets/churn.duckdb
2025-11-02 21:15:58,120 - __main__ - INFO - L77 - SEMILLA: 155555
2025-11-02 21:15:58,120 - __main__ - INFO - L78 - MES_TRAIN: [202102, 202103]
2025-11-02 21:15:58,120 - __main__ - INFO - L79 - MES_VALIDACION: [202103]
2025-11-02 21:15:58,120 - __main__ - INFO - L80 - MES_TEST: [202104]
2025-11-02 21:15:58,120 - __main__ - INFO - L81 - GANANCIA_ACIERTO: 780000
2025-11-02 21:15:58,120 - __main__ - INFO - L82 - COSTO_ESTIMULO: 20000
2025-11-02 21:15:58,120 - __main__ - INFO - L86 - Entrenando con SEMILLA=155555, TRAIN=[202102, 202103], VALID=[202103]
2025-11-02 21:15:58,120 - __main__ - INFO - L87 - Iniciando Pipeline desde el punto: PREDICT
2025-11-02 21:15:58,120 - __main__ - INFO - L98 - Usando base de datos existente...
2025-11-02 21:15:58,120 - __main__ - INFO - L100 - Cargando dataset comision_01...
2025-11-02 21:15:58,120 - src.loader - INFO - L69 - Cargando base de datos competencia_01...
2025-11-02 21:16:00,508 - src.loader - INFO - L74 - shape: (5, 155)
┌───────────┬──────────┬───────────┬───────────┬───┬───────────┬───────────┬───────────┬───────────┐
│ numero_de ┆ foto_mes ┆ active_qu ┆ cliente_v ┆ … ┆ Visa_ccon ┆ Visa_cade ┆ Visa_mpag ┆ clase_ter │
│ _cliente  ┆ ---      ┆ arter     ┆ ip        ┆   ┆ sumos     ┆ lantosefe ┆ ominimo   ┆ naria     │
│ ---       ┆ i64      ┆ ---       ┆ ---       ┆   ┆ ---       ┆ ctivo     ┆ ---       ┆ ---       │
│ i64       ┆          ┆ i64       ┆ i64       ┆   ┆ i64       ┆ ---       ┆ f64       ┆ str       │
│           ┆          ┆           ┆           ┆   ┆           ┆ i64       ┆           ┆           │
╞═══════════╪══════════╪═══════════╪═══════════╪═══╪═══════════╪═══════════╪═══════════╪═══════════╡
│ 249221323 ┆ 202101   ┆ 1         ┆ 0         ┆ … ┆ 6         ┆ 0         ┆ 9559.95   ┆ CONTINUA  │
│ 249227600 ┆ 202101   ┆ 1         ┆ 0         ┆ … ┆ 8         ┆ 0         ┆ 1900.26   ┆ CONTINUA  │
│ 249234235 ┆ 202101   ┆ 1         ┆ 0         ┆ … ┆ 2         ┆ 0         ┆ 6885.51   ┆ CONTINUA  │
│ 249244449 ┆ 202101   ┆ 1         ┆ 0         ┆ … ┆ 8         ┆ 0         ┆ 1219.92   ┆ CONTINUA  │
│ 249244739 ┆ 202101   ┆ 1         ┆ 0         ┆ … ┆ 8         ┆ 0         ┆ 2627.52   ┆ CONTINUA  │
└───────────┴──────────┴───────────┴───────────┴───┴───────────┴───────────┴───────────┴───────────┘
2025-11-02 21:16:00,628 - src.loader - INFO - L83 - Se ha cargado la base de datos
2025-11-02 21:16:00,628 - __main__ - INFO - L104 - Binarizando target...
2025-11-02 21:16:00,628 - src.optimization - INFO - L23 - Asignando Pesos a los targets
2025-11-02 21:16:00,644 - src.optimization - INFO - L31 - Creando targets binarios 1 y 2
2025-11-02 21:16:00,651 - __main__ - INFO - L111 - #### INICIO FEATURE ENGINEERING ###
2025-11-02 21:16:00,652 - __main__ - INFO - L112 - Creando Lags...
2025-11-02 21:16:08,886 - src.features - INFO - L53 - Se han calculado lags de 1 orden para 155 columnas.
2025-11-02 21:16:08,887 - __main__ - INFO - L120 - Creando Deltas...
2025-11-02 21:16:21,652 - src.features - INFO - L121 - Se han calculado 1 deltas para 155 campos.
2025-11-02 21:16:21,655 - __main__ - INFO - L122 - Data shape: (978439, 623)
2025-11-02 21:16:21,655 - __main__ - INFO - L123 - #### FIN FEATURE ENGINEERING ###
2025-11-02 21:16:21,655 - src.optimization - INFO - L43 - Dividiendo datos en train y test...
2025-11-02 21:16:22,186 - src.optimization - INFO - L48 - Dropeando: ['clase_ternaria', 'clase_peso', 'clase_binaria1', 'clase_binaria2'] ...
2025-11-02 21:16:22,925 - __main__ - INFO - L143 - Seteando path de BBDD Optuna: sqlite:////home/joaquinrk_data/buckets/b1/optimizations/optuna_study.db - lgb_optimization_exp1_vm
2025-11-02 21:16:22,926 - __main__ - INFO - L144 - Iniciando estudio...
[I 2025-11-02 21:18:12,606] Trial 0 finished with value: 1523180000.0 and parameters: {'num_leaves': 2091, 'learning_rate': 0.08591318655161881, 'min_data_in_leaf': 4538, 'feature_fraction': 0.541051815266313, 'bagging_fraction': 0.6755751758284505, 'lambda_1': 4.23106460124461, 'lambda_2': 9.807641983846155}. Best is trial 0 with value: 1523180000.0.
[I 2025-11-02 21:19:46,855] Trial 1 finished with value: 1508900000.0 and parameters: {'num_leaves': 2056, 'learning_rate': 0.14433147725515982, 'min_data_in_leaf': 7843, 'feature_fraction': 0.37454241292069557, 'bagging_fraction': 0.6832397659072333, 'lambda_1': 4.385722446796244, 'lambda_2': 0.5967789660956835}. Best is trial 0 with value: 1523180000.0.
[I 2025-11-02 21:21:04,955] Trial 2 finished with value: 1527420000.0 and parameters: {'num_leaves': 1196, 'learning_rate': 0.2214248221790375, 'min_data_in_leaf': 3650, 'feature_fraction': 0.24036140491799404, 'bagging_fraction': 0.5252410990734707, 'lambda_1': 5.318275870968661, 'lambda_2': 6.344009585513211}. Best is trial 2 with value: 1527420000.0.
[I 2025-11-02 21:22:22,355] Trial 3 finished with value: 538300000.0 and parameters: {'num_leaves': 2549, 'learning_rate': 0.2173641519257045, 'min_data_in_leaf': 12221, 'feature_fraction': 0.6779547060561772, 'bagging_fraction': 0.3583671310825426, 'lambda_1': 3.617886556223141, 'lambda_2': 2.282632308789556}. Best is trial 2 with value: 1527420000.0.
[I 2025-11-02 21:23:46,060] Trial 4 finished with value: 1523340000.0 and parameters: {'num_leaves': 883, 'learning_rate': 0.18932973954396087, 'min_data_in_leaf': 1843, 'feature_fraction': 0.4469609381436226, 'bagging_fraction': 0.44469021066371506, 'lambda_1': 4.936850976503062, 'lambda_2': 4.258302902958279}. Best is trial 2 with value: 1527420000.0.
[I 2025-11-02 21:25:26,858] Trial 5 finished with value: 545180000.0 and parameters: {'num_leaves': 939, 'learning_rate': 0.12796275695814616, 'min_data_in_leaf': 17868, 'feature_fraction': 0.8553280145631037, 'bagging_fraction': 0.5014693407074693, 'lambda_1': 6.239529517921111, 'lambda_2': 1.1561839507929572}. Best is trial 2 with value: 1527420000.0.
[I 2025-11-02 21:27:57,356] Trial 6 finished with value: 525780000.0 and parameters: {'num_leaves': 954, 'learning_rate': 0.12450638096489418, 'min_data_in_leaf': 17327, 'feature_fraction': 0.3003642923172054, 'bagging_fraction': 0.48642741141016355, 'lambda_1': 9.85559785610705, 'lambda_2': 5.194851192598094}. Best is trial 2 with value: 1527420000.0.
[I 2025-11-02 21:30:33,181] Trial 7 finished with value: 538400000.0 and parameters: {'num_leaves': 1840, 'learning_rate': 0.03627653693049809, 'min_data_in_leaf': 16527, 'feature_fraction': 0.5824481027287419, 'bagging_fraction': 0.5360544051731719, 'lambda_1': 3.427638337743084, 'lambda_2': 3.041207890271841}. Best is trial 2 with value: 1527420000.0.
[I 2025-11-02 21:32:35,007] Trial 8 finished with value: 1507260000.0 and parameters: {'num_leaves': 1253, 'learning_rate': 0.2044220996612597, 'min_data_in_leaf': 17510, 'feature_fraction': 0.5083378699824089, 'bagging_fraction': 0.6354510263698179, 'lambda_1': 5.859365525622129, 'lambda_2': 6.249035020955999}. Best is trial 2 with value: 1527420000.0.
[I 2025-11-02 21:33:40,126] Trial 9 finished with value: 1509460000.0 and parameters: {'num_leaves': 2025, 'learning_rate': 0.25271849704231514, 'min_data_in_leaf': 1664, 'feature_fraction': 0.7109462731546706, 'bagging_fraction': 0.2949330996294992, 'lambda_1': 1.9422296057877086, 'lambda_2': 5.724569574914731}. Best is trial 2 with value: 1527420000.0.
2025-11-02 21:33:45,329 - __main__ - INFO - L155 - #### FIN OPTIMIZACIÓN HIPERPARAMETROS ####
2025-11-02 21:33:45,329 - __main__ - INFO - L172 - Entrenando modelos Top-K...
2025-11-02 21:33:49,178 - __main__ - ERROR - L188 - Se cortó ejecución por un error:
 [Errno 13] Permission denied: '/home/joacosk/Documents/maestria/Q2/script_project/src/models/lgb_optimization_exp1_vm'
2025-11-02 21:33:49,178 - __main__ - INFO - L190 - Fin Corrida
